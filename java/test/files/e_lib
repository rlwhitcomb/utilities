#
# Testing of some of the Calc standard library functions
#
:clear
:separators off
:quiet on
:open 'test/files/library'
:quiet pop

excel_date(d'2021/10/8')
excel_date_1904(D'12/7/1941')
rad_to_deg(pi/4)
deg_to_rad(135)
dow_name(D'10/13/1957')
moy_name(D'9/11/2001')
long_date(D'11/11/1918')
flat_map([[[1,2],[3,4]],[[5,6],[7,8]],[[9,10],[11,12]]])
is_perfect(28)
is_perfect(99)
quad(3,-4,-9)
quad(1,0,-25)
quad(1, -1, -1)[0]
quad(1, 0, 4)
quad_exp(1, 0, 4, (0,2) )
quad_exp(1, 0, 4, (0,-2) )

zeta_2n(2)

win_pct(25,75)
win_pct(662,174,2)

mean_stddev([1, 2, 3, 4, 5, 6, 7, 8])

:silencedirectives on
:quotestrings off
help_mort
monthly(244000, 3.25, 30)
PMT2(350000, 0.3, 180)
:quotestrings pop
:silencedirectives pop

s1 = eval stack
isempty(s1)
peek(s1)
push(s1, 'abc')
isempty(s1)
push(s1, 'def')
peek(s1)
s1
pop(s1)
peek(s1)
pop(s1)
isempty(s1)
peek(s1)
pop(s1)
isempty(s1)
 
to_excel_col(1)
to_excel_col(2)
to_excel_col(25)
to_excel_col(26)
to_excel_col(27)
to_excel_col(32)
to_excel_col(52)
to_excel_col(53)
to_excel_col(256)
to_excel_col(702)
to_excel_col(16384)

from_excel_col('A')
from_excel_col('Z')
from_excel_col('AA')
from_excel_col('AF')
from_excel_col('ZZ')
from_excel_col('XFD')

:echo 'Checking all columns from 1 - 16384 ...'
:quiet on
_tests = 0
_mistakes = 0
loop over 16384 { _tests++; if from_excel_col(to_excel_col($_)) != $_ { _mistakes++ } }
:quiet pop
:echo `Number of tests = $_tests, mistakes = $_mistakes`

hash('test/data/Declaration.txt',,true)
hashstring('Four score and seven years ago')

:separators pop
:clear

